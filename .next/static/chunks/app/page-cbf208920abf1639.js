(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[931],{4294:function(e,r,t){Promise.resolve().then(t.bind(t,1155))},1155:function(e,r,t){"use strict";t.r(r),t.d(r,{default:function(){return a}});var n=t(7437),s=t(2265),d=t(9435),i=t(9630);function o(e){let{onCreated:r}=e,t=(0,d.A)(),{user:o}=(0,i.a)(),[l,a]=(0,s.useState)(""),[c,u]=(0,s.useState)(""),[p,h]=(0,s.useState)(""),[g,x]=(0,s.useState)(null),[m,b]=(0,s.useState)(!1);async function y(e){if(e.preventDefault(),x(null),b(!0),!o){x("Please sign in first."),b(!1);return}try{console.log("user",o);let{data:e,error:n}=await t.from("businesses").insert({name:l,category:c,city:p||null,owner:o.id}).select("*").single();n?x(n.message):(r(e),a(""),u(""),h(""),x("Business created successfully!"),setTimeout(()=>x(null),3e3))}catch(e){x("An unexpected error occurred")}finally{b(!1)}}return o?(0,n.jsxs)("div",{style:{margin:"2rem 0",padding:"1.5rem",backgroundColor:"white",borderRadius:"8px",boxShadow:"0 2px 4px rgba(0,0,0,0.1)",border:"1px solid #ddd"},children:[(0,n.jsx)("h3",{style:{margin:"0 0 1rem 0",color:"#333"},children:"Add New Business"}),(0,n.jsxs)("form",{onSubmit:y,style:{display:"grid",gap:"1rem",maxWidth:"500px"},children:[(0,n.jsxs)("div",{children:[(0,n.jsx)("label",{style:{display:"block",marginBottom:"0.5rem",fontWeight:"500",color:"#333"},children:"Business Name *"}),(0,n.jsx)("input",{placeholder:"Enter business name",value:l,onChange:e=>a(e.target.value),required:!0,style:{width:"100%",padding:"0.75rem",border:"1px solid #ddd",borderRadius:"4px",fontSize:"1rem"}})]}),(0,n.jsxs)("div",{children:[(0,n.jsx)("label",{style:{display:"block",marginBottom:"0.5rem",fontWeight:"500",color:"#333"},children:"Category *"}),(0,n.jsx)("input",{placeholder:"e.g., Restaurant, Retail, Services",value:c,onChange:e=>u(e.target.value),required:!0,style:{width:"100%",padding:"0.75rem",border:"1px solid #ddd",borderRadius:"4px",fontSize:"1rem"}})]}),(0,n.jsxs)("div",{children:[(0,n.jsx)("label",{style:{display:"block",marginBottom:"0.5rem",fontWeight:"500",color:"#333"},children:"City"}),(0,n.jsx)("input",{placeholder:"Enter city (optional)",value:p,onChange:e=>h(e.target.value),style:{width:"100%",padding:"0.75rem",border:"1px solid #ddd",borderRadius:"4px",fontSize:"1rem"}})]}),(0,n.jsx)("button",{type:"submit",disabled:m,style:{padding:"0.75rem 1.5rem",backgroundColor:m?"#6c757d":"#007bff",color:"white",border:"none",borderRadius:"4px",cursor:m?"not-allowed":"pointer",fontSize:"1rem",fontWeight:"500",transition:"background-color 0.2s"},children:m?"Creating...":"Add Business"}),g&&(0,n.jsx)("p",{style:{color:g.includes("successfully")?"#28a745":"#dc3545",margin:"0.5rem 0 0 0",padding:"0.5rem",backgroundColor:g.includes("successfully")?"#d4edda":"#f8d7da",border:"1px solid ".concat(g.includes("successfully")?"#c3e6cb":"#f5c6cb"),borderRadius:"4px"},children:g})]})]}):(0,n.jsx)("div",{style:{padding:"1rem",backgroundColor:"#fff3cd",border:"1px solid #ffeaa7",borderRadius:"4px",color:"#856404"},children:"Please sign in to add a business."})}function l(e){let{onAuthSuccess:r}=e,t=(0,d.A)(),[i,o]=(0,s.useState)(!0),[l,a]=(0,s.useState)(""),[c,u]=(0,s.useState)(""),[p,h]=(0,s.useState)(!1),[g,x]=(0,s.useState)(null),m=async e=>{e.preventDefault(),h(!0),x(null);try{if(i){let{error:e}=await t.auth.signInWithPassword({email:l,password:c});e?x(e.message):r()}else{let{error:e}=await t.auth.signUp({email:l,password:c});e?x(e.message):x("Check your email for the confirmation link!")}}catch(e){x("An unexpected error occurred")}finally{h(!1)}};return(0,n.jsxs)("div",{style:{maxWidth:"400px",margin:"2rem auto",padding:"2rem",border:"1px solid #ddd",borderRadius:"8px",backgroundColor:"#f9f9f9"},children:[(0,n.jsx)("h2",{children:i?"Sign In":"Sign Up"}),(0,n.jsxs)("form",{onSubmit:m,style:{display:"flex",flexDirection:"column",gap:"1rem"},children:[(0,n.jsx)("input",{type:"email",placeholder:"Email",value:l,onChange:e=>a(e.target.value),required:!0,style:{padding:"0.5rem",border:"1px solid #ccc",borderRadius:"4px"}}),(0,n.jsx)("input",{type:"password",placeholder:"Password",value:c,onChange:e=>u(e.target.value),required:!0,style:{padding:"0.5rem",border:"1px solid #ccc",borderRadius:"4px"}}),(0,n.jsx)("button",{type:"submit",disabled:p,style:{padding:"0.75rem",backgroundColor:"#007bff",color:"white",border:"none",borderRadius:"4px",cursor:p?"not-allowed":"pointer",opacity:p?.7:1},children:p?"Loading...":i?"Sign In":"Sign Up"})]}),(0,n.jsxs)("p",{style:{textAlign:"center",marginTop:"1rem"},children:[i?"Don't have an account? ":"Already have an account? ",(0,n.jsx)("button",{type:"button",onClick:()=>o(!i),style:{background:"none",border:"none",color:"#007bff",cursor:"pointer",textDecoration:"underline"},children:i?"Sign up":"Sign in"})]}),g&&(0,n.jsx)("p",{style:{color:g.includes("error")||g.includes("Error")?"#dc3545":"#28a745",textAlign:"center",marginTop:"1rem"},children:g})]})}function a(){let{user:e,loading:r}=(0,i.a)(),t=(0,d.A)(),[a,c]=(0,s.useState)([]),[u,p]=(0,s.useState)(!0);return((0,s.useEffect)(()=>{if(!e){p(!1);return}(async()=>{let{data:e}=await t.from("businesses").select("*").order("created_at",{ascending:!1});c(e||[]),p(!1)})();let r=t.channel("biz-rt").on("postgres_changes",{event:"INSERT",schema:"public",table:"businesses"},e=>c(r=>[e.new,...r])).subscribe();return()=>{t.removeChannel(r)}},[e,t]),r)?(0,n.jsx)("div",{style:{textAlign:"center",padding:"2rem"},children:(0,n.jsx)("p",{children:"Loading..."})}):e?(0,n.jsxs)("div",{style:{maxWidth:"1200px",margin:"0 auto",padding:"2rem"},children:[(0,n.jsxs)("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center",marginBottom:"2rem",paddingBottom:"1rem",borderBottom:"2px solid #eee"},children:[(0,n.jsx)("h1",{style:{margin:0,color:"#333"},children:"Go Shop Black - Businesses"}),(0,n.jsxs)("div",{style:{display:"flex",alignItems:"center",gap:"1rem"},children:[(0,n.jsxs)("span",{style:{color:"#666"},children:["Welcome, ",e.email]}),(0,n.jsx)("button",{onClick:()=>t.auth.signOut(),style:{padding:"0.5rem 1rem",backgroundColor:"#dc3545",color:"white",border:"none",borderRadius:"4px",cursor:"pointer"},children:"Sign Out"})]})]}),(0,n.jsx)(o,{onCreated:e=>c(r=>[e,...r])}),(0,n.jsxs)("div",{style:{marginTop:"2rem"},children:[(0,n.jsx)("h2",{style:{marginBottom:"1rem",color:"#333"},children:"All Businesses"}),u?(0,n.jsx)("p",{style:{textAlign:"center",padding:"2rem"},children:"Loading businesses..."}):(0,n.jsx)("div",{style:{overflow:"auto",border:"1px solid #ddd",borderRadius:"8px",boxShadow:"0 2px 4px rgba(0,0,0,0.1)"},children:(0,n.jsxs)("table",{style:{width:"100%",borderCollapse:"collapse",backgroundColor:"white"},children:[(0,n.jsx)("thead",{style:{backgroundColor:"#f8f9fa"},children:(0,n.jsxs)("tr",{children:[(0,n.jsx)("th",{style:{padding:"1rem",textAlign:"left",borderBottom:"1px solid #ddd"},children:"Name"}),(0,n.jsx)("th",{style:{padding:"1rem",textAlign:"left",borderBottom:"1px solid #ddd"},children:"Category"}),(0,n.jsx)("th",{style:{padding:"1rem",textAlign:"left",borderBottom:"1px solid #ddd"},children:"City"}),(0,n.jsx)("th",{style:{padding:"1rem",textAlign:"left",borderBottom:"1px solid #ddd"},children:"Created"})]})}),(0,n.jsx)("tbody",{children:0===a.length?(0,n.jsx)("tr",{children:(0,n.jsx)("td",{colSpan:4,style:{padding:"2rem",textAlign:"center",color:"#666"},children:"No businesses found. Be the first to add one!"})}):a.map(e=>(0,n.jsxs)("tr",{style:{borderBottom:"1px solid #eee"},children:[(0,n.jsx)("td",{style:{padding:"1rem",fontWeight:"500"},children:e.name}),(0,n.jsx)("td",{style:{padding:"1rem"},children:(0,n.jsx)("span",{style:{backgroundColor:"#e3f2fd",color:"#1976d2",padding:"0.25rem 0.5rem",borderRadius:"12px",fontSize:"0.875rem"},children:e.category})}),(0,n.jsx)("td",{style:{padding:"1rem",color:"#666"},children:e.city||"N/A"}),(0,n.jsx)("td",{style:{padding:"1rem",color:"#666",fontSize:"0.875rem"},children:new Date(e.created_at).toLocaleString()})]},e.id))})]})})]})]}):(0,n.jsx)(l,{onAuthSuccess:()=>window.location.reload()})}},9435:function(e,r,t){"use strict";t.d(r,{A:function(){return d}});var n=t(2835);let s=null;function d(){return s||(s=(0,n.eI)("https://tdpprnuypcwvuzbmpzxh.supabase.co","eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6InRkcHBybnV5cGN3dnV6Ym1wenhoIiwicm9sZSI6ImFub24iLCJpYXQiOjE3NTk4MTc2ODMsImV4cCI6MjA3NTM5MzY4M30.sYFFcbVKY6gKd2YqWFlcwrmSfV0VxpWZyqlGLMNWocs",{auth:{persistSession:!0,storageKey:"gsb-supabase-auth"}}))}},9630:function(e,r,t){"use strict";t.d(r,{AuthProvider:function(){return o},a:function(){return l}});var n=t(7437),s=t(2265),d=t(9435);let i=(0,s.createContext)(void 0);function o(e){let{children:r}=e,[t,o]=(0,s.useState)(null),[l,a]=(0,s.useState)(!0),c=(0,d.A)();(0,s.useEffect)(()=>{(async()=>{var e;let{data:{session:r}}=await c.auth.getSession();o(null!==(e=null==r?void 0:r.user)&&void 0!==e?e:null),a(!1)})();let{data:{subscription:e}}=c.auth.onAuthStateChange(async(e,r)=>{var t;o(null!==(t=null==r?void 0:r.user)&&void 0!==t?t:null),a(!1)});return()=>e.unsubscribe()},[c.auth]);let u=async()=>{await c.auth.signOut()};return(0,n.jsx)(i.Provider,{value:{user:t,loading:l,signOut:u},children:r})}function l(){let e=(0,s.useContext)(i);if(void 0===e)throw Error("useAuth must be used within an AuthProvider");return e}}},function(e){e.O(0,[835,971,23,744],function(){return e(e.s=4294)}),_N_E=e.O()}]);